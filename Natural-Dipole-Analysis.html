<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Natural Dipole Analysis - </title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




<style type="text/css">

/*some stuff for output/input prompts*/
div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.cell.selected{border-radius:4px;border:thin #ababab solid}
div.cell.edit_mode{border-radius:4px;border:thin #008000 solid}
div.cell{width:100%;padding:5px 5px 5px 0;margin:0;outline:none}
div.prompt{min-width:11ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}
@media (max-width:480px){div.prompt{text-align:left}}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;line-height:1.21429em}
div.prompt:empty{padding-top:0;padding-bottom:0}
div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:horizontal;-moz-box-align:stretch;display:box;box-orient:horizontal;box-align:stretch;}
div.inner_cell{width:90%;}
div.input_area{border:1px solid #cfcfcf;border-radius:4px;background:#f7f7f7;}
div.input_prompt{color:navy;border-top:1px solid transparent;}
div.output_wrapper{margin-top:5px;position:relative;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:4px;-webkit-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);-moz-box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);box-shadow:inset 0 2px 8px rgba(0, 0, 0, 0.8);}
div.output_collapsed{margin:0px;padding:0px;display:-webkit-box;-webkit-box-orient:vertical;-webkit-box-align:stretch;display:-moz-box;-moz-box-orient:vertical;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;width:100%;}
div.out_prompt_overlay{height:100%;padding:0px 0.4em;position:absolute;border-radius:4px;}
div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000000;-moz-box-shadow:inset 0 0 1px #000000;box-shadow:inset 0 0 1px #000000;background:rgba(240, 240, 240, 0.5);}
div.output_prompt{color:darkred;}

a.anchor-link:link{text-decoration:none;padding:0px 20px;visibility:hidden;}
h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible;}
/* end stuff for output/input prompts*/


.highlight-ipynb .hll { background-color: #ffffcc }
.highlight-ipynb  { background: #f8f8f8; }
.highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */
.highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */
.highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */
.highlight-ipynb .o { color: #666666 } /* Operator */
.highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */
.highlight-ipynb .ge { font-style: italic } /* Generic.Emph */
.highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */
.highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */
.highlight-ipynb .go { color: #888888 } /* Generic.Output */
.highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */
.highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */
.highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */
.highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */
.highlight-ipynb .m { color: #666666 } /* Literal.Number */
.highlight-ipynb .s { color: #BA2121 } /* Literal.String */
.highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */
.highlight-ipynb .nb { color: #008000 } /* Name.Builtin */
.highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight-ipynb .no { color: #880000 } /* Name.Constant */
.highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */
.highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight-ipynb .nf { color: #0000FF } /* Name.Function */
.highlight-ipynb .nl { color: #A0A000 } /* Name.Label */
.highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight-ipynb .nv { color: #19177C } /* Name.Variable */
.highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */
.highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */
.highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */
.highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */
.highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */
.highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */
.highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */
.highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */
.highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */
.highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */
.highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */
.highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */
</style>

<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
div.entry-content {
  overflow: visible;
  padding: 8px;
}
.input_area {
  padding: 0.2em;
}

a.heading-anchor {
 white-space: normal;
}

.rendered_html
code {
 font-size: .8em;
}

pre.ipynb {
  color: black;
  background: #f7f7f7;
  border: none;
  box-shadow: none;
  margin-bottom: 0;
  padding: 0;
  margin: 0px;
  font-size: 13px;
}

/* remove the prompt div from text cells */
div.text_cell .prompt {
    display: none;
}

/* remove horizontal padding from text cells, */
/* so it aligns with outer body text */
div.text_cell_render {
    padding: 0.5em 0em;
}

img.anim_icon{padding:0; border:0; vertical-align:middle; -webkit-box-shadow:none; -box-shadow:none}
</style>

<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'left', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>
    <link href="./images/fav.png" rel="icon">

<link rel="canonical" href="./Natural-Dipole-Analysis.html">

        <meta name="author" content="Marcel Patek" />
        <meta name="keywords" content="Blogging,iPython Notebook" />
        <meta name="description" content="Processing NBO output for NLMO molecular dipole moment and plotting results." />

        <meta property="og:site_name" content="" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Natural Dipole Analysis"/>
        <meta property="og:url" content="./Natural-Dipole-Analysis.html"/>
        <meta property="og:description" content="Processing NBO output for NLMO molecular dipole moment and plotting results."/>
        <meta property="article:published_time" content="2015-08-15" />
            <meta property="article:section" content="NBO" />
            <meta property="article:tag" content="Blogging" />
            <meta property="article:tag" content="iPython Notebook" />
            <meta property="article:author" content="Marcel Patek" />


    <!-- Bootstrap -->
     <link rel="stylesheet" href="./theme/css/bootstrap.cerulean.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/default.css" rel="stylesheet">
    <link href="./theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>
        <link href="./extras/custom.css" rel="stylesheet">


	<!-- Google Analytics -->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	
	  ga('create', 'UA-66366688-1', 'auto');
	  ga('require', 'linkid', 'linkid.js');
	  ga('send', 'pageview');
	
	</script>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
Home            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/archives.html">All</a></li>
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                         <li><a href="./pages/contact.html">
                             Contacts
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="./search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="./archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<style>
	#banner{
	    background-image:url("./images/header_img.png");
	}
</style>

<div id="banner">
	<div class="container">
		<div class="copy">
			<h1></h1>
		</div>
	</div>
</div><!-- End Banner -->
<!-- PROFILE_IMG-->
<style>
	#profile_img{
	    background-image:url("./images/headim.png");
	}
</style>

<div id="profile_img">
</div><!-- CONTAINER -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./Natural-Dipole-Analysis.html"
                       rel="bookmark"
                       title="Permalink to Natural Dipole Analysis">
                        Natural Dipole Analysis
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-08-15T14:00:00-06:00"> 2015-08-15</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="./tag/blogging.html">Blogging</a>
        /
	<a href="./tag/ipython-notebook.html">iPython Notebook</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h3 id="blogging-with-ipython-notebook">Blogging with IPython Notebook</h3>
<p>IPython Notebook (<a href="https://jupyter.org/">Jupyter notebook</a>) is a web-based interactive computing platform that combines live code, equations, text, images, and other media. These documents provide a complete record of computation approach that can be shared with others. Also, the IPython Notebook is not only a tool for scientific research and data analysis, but also a great tool for teaching. Technically, Notebook launches a web-based shell to an IPython session that has handy features, like the ability to save, edit, and delete lines of code. The code is organized into cells of Python, text, or Markdown. One can move the cells around, develop code interactively with documentation and notes, display objects that a browser can render (e.g., images, HTML, videos) and to share the whole notebook for a collaborative work. </p>
<p>To demonstrate the utility and benefits of using IPython Notebook, the notebook  decribed in this blog discusses Python code to analyse <code>Natural dipole moment</code> and its components.</p>
<p>Steps of installing iPython notebook on Windows (as a part of Anaconda package) are described in blog <a href="http://bit.ly/1BuFZmb">"Analyzing NBO Results with IPython Notebook"</a></p>
<p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook discusses Python code to analyse Natural dipole moment of planar molecules. In the "<em>DIPOLE MOMENT ANALYSIS</em>" section, the NBO output file (.nbo, .out) contains individual x,y,z-components and length of the total molecular dipole moment. Each of the entries is decomposed into individual NLMO and NBO bond contributions. On the example of formamide, we are going to extract those lines and build a vector (NLMO) representation of the total molecular dipole.</p>
<p>Similar method using Java-based KNIME platform is described <a href="http://bit.ly/1GzVcFV">here</a>.</p>
<p>Details of the formamide analysis can be found in the excellent book of Weinhold and Landis:
Weinhold, F. and Landis, C.R. in <a href="http://www.amazon.com/Discovering-Chemistry-With-Natural-Orbitals/dp/1118119967">Discovering Chemistry with Natural Bond Orbitals</a>, pp. 147-152.</p>

</div>
</div>
</div>
<img alt="Formamide" src="./notebook/dipoles-blog/img/form.png" /> <span style="color:blue; margin-left: 290px">Planar geometry of formamide</span>

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Electric-Dipole">Electric Dipole<a class="anchor-link" href="#Electric-Dipole">&#182;</a></h2><p>Electric dipole moment is the most fundamental quantity related to the charge distribution in a molecule. It reflects the degree to which positive and negative charge is distributed relative to one another. Dipole moment is a vector quantity characterized by its scalar magnitude, sign, and direction. Accordingly, the dipole can be described by its vector <strong>Î¼</strong> directed from the negative to the positive charge. Magnitude of the dipole moment is defined as: $$\mu = |q|*R,$$ where <strong>q</strong> is charge and <strong>R</strong> is the displacement vector pointing from the <strong>negative</strong> to <strong>positive</strong> charge. The net dipole moment of a molecule can be conceptually described as a vector sum of the individual moments.<br>
This is what we will attempt to do in the following cells.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Styling-and-Imports">Styling and Imports<a class="anchor-link" href="#Styling-and-Imports">&#182;</a></h3><p>First the custom styling. File <code>*.css</code> inserts contents of custom .css file into the 
header of the notebook's HTML file. Other variants of .css files are in the ./css directory and differ only in color decoration of iPython notebook cells. This step is optional and the <code>if ... else</code> statement can be commented out.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="o">%%</span><span class="k">capture</span>
# suppress output; remove %% capture for debugging
# to (de)activate line numbering pres Esc while in the cell 
# followed by l (lower L)

&#39;&#39;&#39;Sanity check since we are changing directories and *.css file path
would be incorrect after cell re-run&#39;&#39;&#39;
from IPython.core.display import HTML
import string,sys,os,os.path,re
css_file = &#39;./css/blog.css&#39;
if os.path.isfile(css_file):
    css_file
else:
    %cd ..
HTML(open(css_file, &quot;r&quot;).read())
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[17]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
@import url("custom.css");

<link href='http://fonts.googleapis.com/css?family=Alegreya+Sans:100,300,400,500,700,800,900,100italic,300italic,400italic,500italic,700italic,800italic,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Arvo:400,700,400italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Shadows+Into+Light' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Philosopher:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

<style>

@font-face {
    font-family: "Computer Modern";
    src: url('http://mirrors.ctan.org/fonts/cm-unicode/fonts/otf/cmunss.otf');
}

em {	text-decoration: underline;
	color: rgba(136,0,34,0.8);
}

#notebook_panel { /* main background */
    background: inherit;
    color: #f6f6f6;
}

div.cell { /* set cell width to about 80 chars */
    width: 900px;
}
div #notebook { /* centre the content */
    background: #fff; /* white background for content */
    width: 1000px;
    margin: auto;
    padding-left: 1em;
}
#notebook li { /* More space between bullet points */
margin-top:0.8em;
}
/* draw border around running cells */
div.cell.border-box-sizing.code_cell.running {
    border: 3px solid #887DA3;
}
/* draw border around last active cells */
div.cell.selected {
	border: thin solid #5E68D2 !important;
}
/* Put a solid color box around each cell and its output, visually linking them together */
div.cell.code_cell {
    background-color: rgba(235,235,235,1); /*171,165,131,0.3,  159,115,0, 0.3*/
    border-radius: 10px; /* rounded borders */
    padding: 1em;
    margin-top: 1em;
    margin-left: 2.5em;
}
/*the width, font, and size of text in Markdown cells*/
div.text_cell_render{
    font-family: 'Arvo' sans-serif;
    line-height: 130%;
    font-size: 115%;
    width:800px; /* divider line */
    margin-left:auto;
    margin-right:auto;
}
/* Formatting for header cells */
.text_cell_render h1 {
    font-family: 'Philosopher', sans-serif;
    font-weight: 400;
    font-size: 32pt;
    line-height: 100%;
    color: rgb(12,85,97);
    margin-bottom: 0.1em;
    margin-top: 0.1em;
    display: block;
}
.text_cell_render h2 {
    font-family: 'Philosopher', serif;
    font-weight: 700;
    font-size: 24pt;
    line-height: 100%;
    color: rgb(171,165,131);
    margin-bottom: 0.1em;
    margin-top: 0.1em;
    display: block;
}    

.text_cell_render h3 {
    font-family: 'Philosopher', serif;
    margin-top:12px;
    margin-bottom: 3px;
    font-style: italic;
    color: rgb(95,92,72);
}

.text_cell_render h4 {
    font-family: 'Philosopher', serif;
}

.text_cell_render h5 {
    font-family: 'Alegreya Sans', sans-serif;
    font-weight: 300;
    font-size: 16pt;
    color: grey;
    font-style: italic;
    margin-bottom: .1em;
    margin-top: 0.1em;
    display: block;
}

.text_cell_render h6 {
    font-family: 'PT Mono', sans-serif;
    font-weight: 300;
    font-size: 10pt;
    color: grey;
    margin-bottom: 1px;
    margin-top: 1px;
}
/*CodeMirror (a webservice) for syntax highlighting of code*/
.CodeMirror{
        font-family: "PT Mono";
        font-size: 100%;
}

/*Tables*/
table.grid {
	font-family: verdana,arial,sans-serif;
	font-size:11px;
	color:#333333;
	border-width: 1px;
	border-color: #666666;
	border-collapse: collapse;
}
table.grid th {
	border-width: 1px;
	padding: 8px;
	border-style: solid;
	border-color: #666666;
	background-color: #dedede;
}
table.grid td {
	border-width: 1px;
	padding: 8px;
	border-style: solid;
	border-color: #666666;
	background-color: #ffffff;
	text-align: center;
}

div.output_area .rendered_html table {
margin: 20px auto 0 auto;
}

code {
	padding: 2px 4px;
	font-size: 90%;
	color: #c7254e!important;
	background-color: #f9f2f4!important;
	border-radius: 4px;
	font-family: Menlo,Monaco,Consolas,"Courier New",monospace;
}

/* Latex*/
.MathJax_Display {
color: rgba(0,0,255,1);
padding: 10px;
}
/* Important to close style section in Jupyter notebook*/
</style>
</div>

</div>

</div>
</div>

</div></p>
<p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="csv-to-Dataframe">csv to Dataframe<a class="anchor-link" href="#csv-to-Dataframe">&#182;</a></h3><p>In the next step, coordinates of NLMO dipoles are read from *.csv file. This file was generated earlier using the KNIME "Dipole_v2/3" <a href="http://bit.ly/1GzVcFV">workflow</a>. Alternatively, iPython notebook <span style="color:rgba(255,100,0,1)">ReadNboDip.ipynb</span> at this <a href="http://bit.ly/1ztVa1C">Github repository</a> creates the identical input file. "Plain" Python script (<span style="color:rgba(255,100,0,1)">ReadNboDip.py</span>) that parses NBO output files for the same <i>Dipole moment summary</i> can be downloaded from <a href="http://bit.ly/142ZKWZ">this Github repository</a>.</p>
<p>In this example, this file is available from the ./dipole directory.<br></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="o">%%</span><span class="k">capture</span>
# Step into the directory of input .csv files using the magic %cd
# Make sure that we are not already in the &#39;dipoles&#39; dir from the previous run
if os.path.isdir(&#39;dipoles&#39;):
    %cd dipoles
else:
    %cd ..
    %cd dipoles
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, a row of arbitrary values (zeroes) is inserted at the top of dataframe <strong>df</strong> (line 15; press Esc+l (lower L)) and the table values are assigned int, float, or string types, respectively.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Input file can be generated in ReadNboDip.ipynb notebook</span>
<span class="n">infile</span> <span class="o">=</span> <span class="s">&#39;form_dip.csv&#39;</span>  <span class="c"># in directory ./dipoles</span>
<span class="c"># Save the file path, name and extension</span>
<span class="n">fullpath</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
<span class="n">path</span><span class="p">,</span><span class="nb">file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
<span class="n">basename</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>

<span class="c"># Create Pandas dataframe from the *.csv file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
<span class="c"># fix datatype for columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">convert_objects</span><span class="p">(</span><span class="n">convert_numeric</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">dtypes</span> 

<span class="c"># Prepare first blank row with XYZ=0 to set the point of vector origin</span>
<span class="c"># set the first row to zeroes</span>
<span class="n">rowex</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">0</span><span class="p">]]</span> 
<span class="c"># Get dataframe column headers</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="c"># Fix the data types</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;float64&#39;</span> <span class="p">:</span>
        <span class="n">rowex</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">elif</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;int64&#39;</span> <span class="p">:</span>
        <span class="n">rowex</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">rowex</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="n">row0</span> <span class="o">=</span> <span class="n">rowex</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Reassemble data table placing row0 at the top, followed by the rest</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">row0</span><span class="p">,</span> <span class="n">df</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">ix</span><span class="p">[::]</span>
<span class="c"># print df2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="sd">&quot;&quot;&quot; Identify which column (coordinate) has constant values (orthogonal to the </span>
<span class="sd">molecular plane).</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c"># Prepare stds of absolute values for each x,y,z column</span>
<span class="c"># Smallest stds indicate constant dimension perpendicular to 2D plane</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">C1std</span> <span class="o">=</span> <span class="n">C1</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">C2std</span> <span class="o">=</span> <span class="n">C2</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">C3</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Z&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">C3std</span> <span class="o">=</span> <span class="n">C3</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="c"># print &quot;stds are: %.3f %.3f %.3f&quot; % (C1std, C2std, C3std)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="sd">&#39;&#39;&#39;Assign X,Y coordinates only, Z=0. Any of the X,Y,Z can be constant or </span>
<span class="sd">zero 0 (which one may change every time). </span>
<span class="sd">Remap coordinates arbitrarily to X,Y with Z=[const] &#39;&#39;&#39;</span>
<span class="k">def</span> <span class="nf">coord_headers</span><span class="p">(</span><span class="n">C1std</span><span class="p">,</span> <span class="n">C2std</span><span class="p">,</span> <span class="n">C3std</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">C1std</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="ow">and</span> <span class="n">C2std</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="o">&gt;</span> <span class="n">C3std</span><span class="p">:</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Y&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">C1std</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="o">&gt;</span> <span class="n">C2std</span> <span class="ow">and</span> <span class="n">C3std</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Z&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">C1std</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="o">&lt;</span> <span class="n">C2std</span> <span class="ow">and</span> <span class="n">C3std</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Y&quot;</span><span class="p">]</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Z&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">]</span>
        <span class="n">df2</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s">&quot;Y&quot;</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Append columns newX,newY to df2 (values are often same as the original X,Y)</span>
<span class="c"># Plane defined</span>
<span class="n">coord_headers</span><span class="p">(</span><span class="n">C1std</span><span class="p">,</span> <span class="n">C2std</span><span class="p">,</span> <span class="n">C3std</span><span class="p">)</span>

<span class="c"># Remove rows with CR (core) orbitals and reindex the dataframe</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="o">~</span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">&quot;CR&quot;</span><span class="p">)]</span>

<span class="c"># Copy dataframe for the intermediate output</span>
<span class="n">df2b1</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">ix</span><span class="p">[::]</span> <span class="c"># Comment off if re-running the cell</span>

<span class="n">HTML</span><span class="p">(</span><span class="n">df2b1</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span> <span class="o">=</span> <span class="s">&#39;grid&#39;</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="c"># table styling requires package qgrid http://nbviewer.ipython.org/github/quantopian/qgrid/</span>
<span class="c"># blob/master/qgrid_demo.ipynb</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe grid">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>index</th>
      <th>NLMO</th>
      <th>Type</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>Tot_Dip</th>
      <th>newX</th>
      <th>newY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td></td>
      <td>0.00</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>LP ( 1) N 1</td>
      <td>-0.20</td>
      <td>0</td>
      <td>-1.64</td>
      <td>1.65</td>
      <td>-0.20</td>
      <td>-1.64</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>LP ( 1) O 3</td>
      <td>-2.37</td>
      <td>0</td>
      <td>-1.64</td>
      <td>2.88</td>
      <td>-2.37</td>
      <td>-1.64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>LP ( 2) O 3</td>
      <td>0.89</td>
      <td>0</td>
      <td>0.75</td>
      <td>1.16</td>
      <td>0.89</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>BD ( 1) N 1- C 2</td>
      <td>0.02</td>
      <td>0</td>
      <td>0.85</td>
      <td>0.85</td>
      <td>0.02</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>BD ( 1) N 1- H 4</td>
      <td>-0.68</td>
      <td>0</td>
      <td>0.47</td>
      <td>0.82</td>
      <td>-0.68</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9</td>
      <td>8</td>
      <td>9</td>
      <td>BD ( 1) N 1- H 5</td>
      <td>0.75</td>
      <td>0</td>
      <td>0.46</td>
      <td>0.88</td>
      <td>0.75</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>7</th>
      <td>10</td>
      <td>9</td>
      <td>10</td>
      <td>BD ( 1) C 2- O 3</td>
      <td>-1.90</td>
      <td>0</td>
      <td>-1.44</td>
      <td>2.38</td>
      <td>-1.90</td>
      <td>-1.44</td>
    </tr>
    <tr>
      <th>8</th>
      <td>11</td>
      <td>10</td>
      <td>11</td>
      <td>BD ( 2) C 2- O 3</td>
      <td>-0.67</td>
      <td>0</td>
      <td>-0.46</td>
      <td>0.81</td>
      <td>-0.67</td>
      <td>-0.46</td>
    </tr>
    <tr>
      <th>9</th>
      <td>12</td>
      <td>11</td>
      <td>12</td>
      <td>BD ( 1) C 2- H 6</td>
      <td>1.72</td>
      <td>0</td>
      <td>-0.58</td>
      <td>1.82</td>
      <td>1.72</td>
      <td>-0.58</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><span style="color: orange"><b>Table 1</b>.  Current df2 with new columns for consolidated X, Y coordinates.</span></center>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h3 id="First-Plot">First Plot<a class="anchor-link" href="#First-Plot">&#182;</a></h3><p>Now, to have dipole vectors continue from one to another (as opposed to all starting at the zero), we have to <em>transpose coordinates</em> in a way that the origin of new vector starts at the end of the previous vector. In Python, use the function <code>cumsum()</code>.
Let's try to build continuous vector graph from the original dataframe <strong>df2</strong>. This is equivalent to a vector decomposition.</p>
<p><span style="color:rgba(217,0,126,1)">**The following cell is just a test case**</span> (can be removed later). It generates plot of <span style="color: orange"><b>Table 1</b></span> as continuing vector segments. You can <a href="#Cleaning-up-the-Vector-Path">skip it and go to section "Cleaning up the Vector Path"</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Test area running off the branch df2b1</span>
<span class="c"># Translate coordinates from X,Y,Z=0,0,0 to assure vector continuity</span>
<span class="n">df2b1</span><span class="p">[</span><span class="s">&#39;newXa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2b1</span><span class="o">.</span><span class="n">newX</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df2b1</span><span class="p">[</span><span class="s">&#39;newYa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2b1</span><span class="o">.</span><span class="n">newY</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df3b</span> <span class="o">=</span> <span class="n">df2b1</span>
<span class="c"># print df3b</span>

<span class="c"># Calculate total dipole (compare with column Tot_Dip)</span>
<span class="n">lastX</span> <span class="o">=</span> <span class="n">df3b</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">newXa</span>  <span class="c"># row and value</span>
<span class="n">lastX</span> <span class="o">=</span> <span class="n">lastX</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># value only</span>
<span class="n">lastY</span> <span class="o">=</span> <span class="n">df3b</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">newYa</span>
<span class="n">lastY</span> <span class="o">=</span> <span class="n">lastY</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">total_dipole</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">lastX</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">lastY</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">total_dipole</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_dipole</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c"># Calc geometrical center of the vector polygon</span>
<span class="n">cenX</span> <span class="o">=</span> <span class="n">df3b</span><span class="p">[</span><span class="s">&#39;newXa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cenY</span> <span class="o">=</span> <span class="n">df3b</span><span class="p">[</span><span class="s">&#39;newYa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df3b</span><span class="o">.</span><span class="n">newXa</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df3b</span><span class="o">.</span><span class="n">newYa</span>

<span class="c"># Plot</span>
<span class="c"># Set rectangular plot dimensions to keep lengths proportional</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ylow</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">yhigh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">lst_sort</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    Sort list of floats by values.</span>
<span class="sd">    </span>
<span class="sd">    :type list: list of floats</span>
<span class="sd">    :param list: max and min x,y-coordinates</span>
<span class="sd">  </span>
<span class="sd">    :rtype: list of floats</span>
<span class="sd">    :return: sorted list of floats    </span>
<span class="sd">    &#39;&#39;&#39;</span>   
    <span class="n">abslist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">abslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">abslist</span><span class="p">)</span>

<span class="n">margins</span> <span class="o">=</span> <span class="n">lst_sort</span><span class="p">([</span><span class="n">xlow</span><span class="p">,</span> <span class="n">ylow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">,</span> <span class="n">yhigh</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c"># To generate multiple distinct plots.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">&#39;Dipole Moments (D)&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="c">#x.min()-1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df3b</span><span class="o">.</span><span class="n">newXa</span><span class="p">,</span> <span class="n">df3b</span><span class="o">.</span><span class="n">newYa</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;NLMOs&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df3b</span><span class="p">[</span><span class="s">&#39;NLMO&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mf">0.3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">lastX</span><span class="p">,</span><span class="n">lastY</span><span class="p">),</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&#39;-&gt;&#39;</span><span class="p">,</span><span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]),(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&#39;&lt;-&#39;</span><span class="p">,</span><span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">total_dipole</span><span class="p">,</span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">lastX</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">lastY</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.1</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s">&#39;offset points&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">,</span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">cenX</span><span class="p">,</span> <span class="n">cenY</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s">&#39;offset points&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Anaconda\envs\notebook\lib\site-packages\matplotlib\text.py:1857: UserWarning: You have used the &#96;textcoords&#96; kwarg, but not the &#96;xytext&#96; kwarg.  This can lead to surprising results.
  warnings.warn(&quot;You have used the &#96;textcoords&#96; kwarg, but not &quot;
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.text.Annotation at 0x7751050&gt;</pre>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
4/Ifl2MLx/fJXymlVOlpzV8ppRyjNX+llFIh+T75u1qzczUucDc2jct/XI4tHN8nf6WUUqWnNX+l
lHKM1vyVUkqF5Pvk72rNztW4wN3YNC7/cTm2cHyf/JVSSpWe1vyVUsoxWvNXSikVku+Tv6s1O1fj
Andj07j8x+XYwvF98ldKqWibMWMGTZo0oWHDhjzyyCNeNycmtOavlFJF5Ofn07hxYz744APq1KlD
mzZteOWVVzj22GO9blrEtOavlFKlNHv2bI455hjq169PxYoVufTSS5k2bZrXzYo63yd/V2t2rsYF
7samcflPqNh+//136tWrt2u7bt26/P7773FsVXz4PvkrpVQ0GVNitcQZvk/+6enpXjchJlyNC9yN
TePyn1Cx1alTh+XLl+/aXr58OXXr1o1jq+LD98lfKaWiqXXr1vz4448sW7aM7du389prr3H++ed7
3ayo833yd7Ue6Wpc4G5sGpf/hIqtQoUKPPnkk5x99tk0bdqU7t27+6qnT6QqeN0ApZRKNB07dqRj
x45eNyOmtJ+/Uko5Rvv5K6WUCsn3yd/VeqSrcYG7sWlc/uNybOH4PvkrpZQqPa35K6WUY7Tmr5RS
KiTfJ39Xa3auxgXuxqZx+Y/LsYXj++SvlFKq9LTmr5RSjtGav1JK7SU7O5uMjM5UrpxG5cppZGR0
Jjs72+tmxZ2nyd8Yc44x5gdjzI/GmP/uzzFcrdm5Ghe4G5vGlfiysgbStWtvAoEubN36C1u3vkgg
0IWuXXuTlTXQ6+bFlWfJ3xhTHngSOAdoCvQwxrg3e5JSKiFkZ2czcuQE8vJygV5ANSAN6EVe3heM
HDkhqb4BeFbzN8a0BwaKyDnB7X4AIjKkyD5a81dKRUVGRmcCgS7YxB/KGNLTp5KTMz2ezYqJRK/5
1wGWF9leEbxPKaWiLjf3E+CCEva4MLhPcvBySueITul79uxJ/fr1AahatSotWrTYtfpOIBBgwYIF
3Hbbbbu2gT0e9+t20TprIrQnmtt7x+h1e6K1PXz48H3+PhOpfcn+fuXn7wQ+Y/cHQABYANwW3P4s
uA8J0d7S5ovx48cD7MqXYYmIJzegHTCjyHYW8N+99pFwcnJywu7jR67GJeJubBpXYktP7yQwRlLY
LNcwRkAEcoI/RWC0pKd38rqZURHMnSXmYC9r/hWAxcCZwEpgNtBDRL4vso941T6llFuys7Pp2rU3
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
AElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div> </p>
<h3 id="cleaning-up-the-vector-path">Cleaning up the Vector Path</h3>
<p>Resulting plot is rather cluttered and thus we will need to arrange dipoles in some way to get a more interpretable view.
Since most molecules have center of the coordinate system placed somewhere at the center of the molecule, sorting dipole coordinates by xy-quadrant in which the dipole origin resides is a sensible approach. The following cartoon indicates how such quadrants are defined.
<img alt="Qadrants" src="./notebook/dipoles-blog/img/quadrants.png" title="Quadrant definition" />
We will write a function that assigns each row an arbitrary quadrant depending on the signs of coordinates <strong>x</strong> and <strong>y</strong>. To further arrange directions of lines in each quadrant, we will include another function that calculates <strong>slope</strong> of the line and we will sort by the <strong>quadrant</strong> (rank) and the <strong>slope</strong>.</p>
<p>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Function to rank XY-points into quadrants 0-3</span>
<span class="k">def</span> <span class="nf">xyrank</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    Assign qudrant value 1,2,3,4.</span>
<span class="sd">    :type inputs: floats and str</span>
<span class="sd">    :param inputs: X, Y, Q(1), Q(2), Q(3), Q(4)  </span>
<span class="sd">    :rtype: str</span>
<span class="sd">    :return: quadrant number as str    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># [Q1]</span>
        <span class="k">return</span> <span class="n">c</span>
    <span class="k">elif</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>  <span class="c"># [Q2]</span>
        <span class="k">return</span> <span class="n">d</span>
    <span class="k">elif</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c"># [Q3]</span>
        <span class="k">return</span> <span class="n">e</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c"># [Q4] 1 a&gt;0, b&lt;0</span>
        <span class="k">return</span> <span class="n">f</span>
        
        
<span class="c"># Function to calculate slope</span>
<span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>  <span class="c"># expects float</span>
        <span class="k">return</span> <span class="n">slope</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c"># for a = zero, set slope arbitrarily to 0</span>
        <span class="k">return</span> <span class="n">slope</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately, it is not obvious which sequence of quadrants will lead to the least cluttered dipole diagram. To make sure that we test all possibilities, we will evaluate all permutations of four quadrants, that is, 4! = 4 x 3 x 2 x 1  = 24</p>
<p>For each trial, we record an array of quadrants and standard deviation of distances of all vector origins from the graph origin (geometric center). Small stds should indicate even distribution of vectors around the origin (circle, ellipsoid, symmetrical polygon?). Standard deviation of distances together with the sequence of quadrants appear at the top of each plot. As we will see later, lowest stds are not necesarilly indicative of the "clean" graph shape.</p>
<p><span style="color:rgba(190,0,0,0.8)"> <u>By no means the resulting vector plots indicate atom connectivity!</u></span> It is the relative direction of dipole vectors that helps us to assess the importance and internal balance of NLMO orbitals within the molecule.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Get the list of quadrant permutations</span>
<span class="c"># Four quadrants of a XY plot</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span>  <span class="c"># Creates a set</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="n">permlist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span>
<span class="n">permlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">permlist</span><span class="p">)</span>  <span class="c"># Get permutation set into a list.</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plot-Survey">Plot Survey<a class="anchor-link" href="#Plot-Survey">&#182;</a></h3><p>For each set of qudrants, the code below will sort the dataframe by the quadrant and slope. The corresponding plot will be created and saved as .png image. Quadrant sequence is part of the filename.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="o">%%</span><span class="k">capture</span>
# remove %%capture magic to see the plot and output

# Iterate through the list of all quadrants
global captarr
captarr = []
captperm = []
for i in range(len(permlist)):
    # Apply function to the table values in each row; make a copy first
    df21 = df2.copy()
    df21[&quot;xyRank&quot;] = df2.apply(
        lambda row: xyrank(row[&#39;newX&#39;], row[&#39;newY&#39;], permlist[i][0], 
                           permlist[i][1], permlist[i][2], permlist[i][3]),
        axis=1)

    # Apply function to table values in a row
    df21[&quot;slope&quot;] = df21.apply(lambda row: slope(row[&#39;newX&#39;], row[&#39;newY&#39;]), axis=1)
    
    toprow = df21[:1]  # row with zero dipole 
    # Directly change rank of the first row in the dataframe
    toprow.xyRank[0] = 4
    # Isolate remaining data into rest (drop)
    rest1 = df21.drop(df21.index[[0, 0]])
    # sort rest1 by xyRank, then by slope - descending
    df3 = rest1.sort_index(by=[&#39;xyRank&#39;, &#39;slope&#39;], ascending=[False, False])
    # Put it back
    df3 = pd.concat([toprow, df3]).reset_index().ix[::]
    df3 = df3.sort_index(by=[&#39;xyRank&#39;, &#39;slope&#39;], ascending=[False, False])

    # Translate coordinates from xyz=0,0,0
    df3[&#39;newXa&#39;] = df3.newX.cumsum()
    df3[&#39;newYa&#39;] = df3.newY.cumsum()

    # Calculate total dipole
    lastX = df3.tail(1).newXa  # row and value
    lastX = lastX.tolist()[0]  # value only
    lastY = df3.tail(1).newYa
    lastY = lastY.tolist()[0]
    total_dipole = sqrt(np.power(lastX, 2) + np.power(lastY, 2))
    total_dipole = round(total_dipole, 2)

    # Calc distances of x,y and assess even distribution of points 
    # around the geom center
    cenX = df3[&#39;newXa&#39;].mean()
    cenY = df3[&#39;newYa&#39;].mean()
    distX = abs(cenX - df3.newXa)
    distY = abs(cenY - df3.newYa)
    # distance from centroid
    distXY = np.sqrt(distX * distX + distY * distY)
    diststd = distXY.std()
    captarr.append(round(diststd, 1))
    captperm.append(permlist[i])
    print &quot;++++++++++ Rank list is : &quot;, permlist[i], &quot;; \
                std of distances is:&quot;, round(diststd, 2)

    # Plot
    plt.figure()  # To generate multiple distinct plots.
    plt.suptitle(&#39;Dipole Moments (D)&#39;)
    ax = []
    x = df3.newXa
    y = df3.newYa
    xmin = x.min() - 1
    xmax = x.max() + 1
    ymin = y.min() - 1
    ymax = y.max() + 1
    plt.ylabel(&#39;Y&#39;)
    plt.xlabel(&#39;X&#39;)
    plt.grid(True)
    plt.xlim(xmin, xmax)
    plt.ylim(ymin, ymax)
    color = &#39;blue&#39;
    plt.scatter(df3.newXa, df3.newYa, s=80, c=color, label=&#39;NLMOs&#39;)
    # plt.plot(df3.newXa, df3.newYa, c=color)
    # plt.legend(loc=1,borderaxespad=0.)
    for j, txt in enumerate(df3[&#39;NLMO&#39;]):
        plt.annotate(txt, (x[j] + 0.1, y[j] + 0.3))
    ax = gca()
    ax.add_patch(FancyArrowPatch((0, 0), (lastX, lastY), arrowstyle=&#39;-&gt;&#39;, \
                                 mutation_scale=20, color=&#39;red&#39;))
    for k in range(1, len(x)):
        ax.add_patch(
            FancyArrowPatch((x[k], y[k]), (x[k - 1], y[k - 1]), arrowstyle=&#39;&lt;-&#39;, \
                            mutation_scale=20, color=&#39;blue&#39;))

    plt.annotate(total_dipole,
                 xy=(lastX / 2 * 0.9, lastY / 2 * 1.1),
                 color=&#39;red&#39;,
                 xycoords=&#39;data&#39;,
                 textcoords=&#39;offset points&#39;)

    plt.annotate(round(diststd, 2),
                 xy=(df3[&#39;newXa&#39;].min() + 1.5, df3[&#39;newYa&#39;].max() + 0.3),
                 color=&#39;green&#39;,
                 xycoords=&#39;data&#39;,
                 textcoords=&#39;offset points&#39;)

    plt.annotate((permlist[i]),  # asumX, asumY, 
                 xy=(xmin + 0.2, ymax - 0.7),
                 color=&#39;black&#39;,
                 xycoords=&#39;data&#39;,
                 textcoords=&#39;offset points&#39;)

    plt.annotate(&quot;+&quot;,
                 xy=(cenX, cenY),
                 color=&#39;red&#39;,
                 xycoords=&#39;data&#39;,
                 textcoords=&#39;offset points&#39;)

    # plt.show()
    f_perm = str(permlist[i]).replace(&quot;(&quot;, &quot;_&quot;)
    f_perm = f_perm.replace(&quot;)&quot;, &quot;_&quot;)
    f_perm = f_perm.replace(&quot;,&quot;,&quot;&quot;)
    f_perm = f_perm.replace(&quot; &quot;,&quot;&quot;)
    pic = basename  + f_perm + &#39;.png&#39;  
    try:
        plt.savefig(pic, ext=&#39;png&#39;, format=&#39;png&#39;, dpi=100)
    except IOError:
        print &quot;Error: can\&#39;t find the file or read data&quot;
</pre></div>

</div>
</div>
</div>

</div></p>
<table>
<thead>
<tr>
<th>Rank</th>
<th>Quadrants</th>
<th>STD distance</th>
</tr>
</thead>
<tbody>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 0, 3, 2)</td>
<td>std of distances is: 1.23</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 0, 2, 1)</td>
<td>std of distances is: 1.08</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 1, 2, 0)</td>
<td>std of distances is: 1.09</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 2, 3, 0)</td>
<td>std of distances is: 1.34</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 0, 1, 3)</td>
<td>std of distances is: 1.26</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 0, 1, 2)</td>
<td>std of distances is: 1.31</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 1, 3, 2)</td>
<td>std of distances is: 1.4</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 2, 1, 3)</td>
<td>std of distances is: 1.02</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 2, 1, 0)</td>
<td>std of distances is: 1.11</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 0, 2, 3)</td>
<td>std of distances is: 1.28</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 3, 2, 0)</td>
<td>std of distances is: 1.22</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 3, 2, 1)</td>
<td>std of distances is: 1.17</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 1, 0, 2)</td>
<td>std of distances is: 1.26</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 1, 2, 3)</td>
<td>std of distances is: 1.38</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 0, 3, 1)</td>
<td>std of distances is: 1.3</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(3, 2, 0, 1)</td>
<td>std of distances is: 1.26</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 2, 3, 1)</td>
<td>std of distances is: 1.33</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(0, 3, 1, 2)</td>
<td>std of distances is: 1.1</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 3, 0, 2)</td>
<td>std of distances is: 1.32</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 3, 0, 1)</td>
<td>std of distances is: 1.35</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(1, 2, 0, 3)</td>
<td>std of distances is: 1.27</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 1, 0, 3)</td>
<td>std of distances is: 1.24</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 3, 1, 0)</td>
<td>std of distances is: 1.2</td>
</tr>
<tr>
<td>++++++++++ Rank list is :</td>
<td>(2, 1, 3, 0)</td>
<td>std of distances is: 1.28</td>
</tr>
</tbody>
</table>
<p>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Sort by distance stds and retrieve the first three results</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">captperm</span><span class="p">,</span> <span class="n">captarr</span><span class="p">)</span>
<span class="n">sor</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span> <span class="n">sor</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[((0, 2, 1, 3), 1.0), ((3, 0, 2, 1), 1.1), ((3, 1, 2, 0), 1.1)]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspect graphs above and note the quadrant sequence of the best looking graph. As indicated earlier, it is not the graph with lowest std value.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Final-Plot">Final Plot<a class="anchor-link" href="#Final-Plot">&#182;</a></h3><p>To make the final plot, enter the quadrant sequence of the best looking plot above (0,3,2,1) and replace the sequence in variable <code>quad</code>. The plot image will be saved in directory ./dipole.</p>
<p><strong><span style="color:blue">Enter the quadrant sequence  (to line 2) and re-run the last part to get the graph.</span></strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># Enter the best sequence of quadrants</span>
<span class="n">quad</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c"># original sequence 0,3,2,1 or 1,3,2,0</span>
<span class="n">df21</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df21</span><span class="p">[</span><span class="s">&quot;xyRank&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">xyrank</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">],</span>\
                 <span class="n">quad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">quad</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">quad</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">quad</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Apply function to table values in a row</span>
<span class="n">df21</span><span class="p">[</span><span class="s">&quot;slope&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df21</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">slope</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">&#39;newX&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s">&#39;newY&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">toprow</span> <span class="o">=</span> <span class="n">df21</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># row with zero dipole </span>
<span class="c"># Directly change cell rank in dataframe</span>
<span class="n">toprow</span><span class="o">.</span><span class="n">xyRank</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c"># Isolate remaining data into rest (drop)</span>
<span class="n">rest1</span> <span class="o">=</span> <span class="n">df21</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df21</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="c"># sort rest1 by xyRank, then by slope - descending</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">rest1</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;xyRank&#39;</span><span class="p">,</span> <span class="s">&#39;slope&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>
<span class="c"># Put it back</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">toprow</span><span class="p">,</span><span class="n">df3</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">ix</span><span class="p">[::]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;xyRank&#39;</span><span class="p">,</span> <span class="s">&#39;slope&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">])</span>


<span class="c"># Translate coordinates from xyz=0,0,0</span>
<span class="n">df3</span><span class="p">[</span><span class="s">&#39;newXa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">newX</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df3</span><span class="p">[</span><span class="s">&#39;newYa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">newY</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="c"># print df3 # works OK</span>

<span class="c"># Calculate total dipole</span>
<span class="n">lastX</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">newXa</span>  <span class="c"># row and value</span>
<span class="n">lastX</span> <span class="o">=</span> <span class="n">lastX</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>  <span class="c"># value only</span>
<span class="n">lastY</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">newYa</span>
<span class="n">lastY</span> <span class="o">=</span> <span class="n">lastY</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">total_dipole</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">lastX</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">lastY</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">total_dipole</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">total_dipole</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c"># Calc distances of x,y and assess fit to a circle</span>
<span class="n">cenX</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s">&#39;newXa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cenY</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s">&#39;newYa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">distX</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cenX</span><span class="o">-</span><span class="n">df3</span><span class="o">.</span><span class="n">newXa</span><span class="p">)</span>
<span class="n">distY</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cenY</span><span class="o">-</span><span class="n">df3</span><span class="o">.</span><span class="n">newYa</span><span class="p">)</span>
<span class="c"># distance from centroid</span>
<span class="n">distXY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">distX</span><span class="o">*</span><span class="n">distX</span> <span class="o">+</span> <span class="n">distY</span><span class="o">*</span><span class="n">distY</span><span class="p">)</span>
<span class="n">diststd</span> <span class="o">=</span> <span class="n">distXY</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">newXa</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">newYa</span>

<span class="c"># Set rectangular plot dimensions to keep lengths proportional</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ylow</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">yhigh</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">lst_sort</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; </span>
<span class="sd">    Sort list of floats by values.</span>
<span class="sd">    </span>
<span class="sd">    :type list: list of floats</span>
<span class="sd">    :param list: max and min x,y-coordinates</span>
<span class="sd">  </span>
<span class="sd">    :rtype: list of floats</span>
<span class="sd">    :return: sorted list of floats    </span>
<span class="sd">    &#39;&#39;&#39;</span>   
    <span class="n">abslist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">abslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">abslist</span><span class="p">)</span>

<span class="n">margins</span> <span class="o">=</span> <span class="n">lst_sort</span><span class="p">([</span><span class="n">xlow</span><span class="p">,</span> <span class="n">ylow</span><span class="p">,</span> <span class="n">xhigh</span><span class="p">,</span> <span class="n">yhigh</span><span class="p">])</span>

<span class="c"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c"># To generate multiple distinct plots.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">&#39;Dipole Moments (D)&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="n">margins</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
<span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">newXa</span><span class="p">,</span> <span class="n">df3</span><span class="o">.</span><span class="n">newYa</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;NLMOs&#39;</span><span class="p">)</span>
<span class="c"># plt.plot(df3.newXa, df3.newYa, c=color)</span>
<span class="c"># plt.legend(loc=1,borderaxespad=0.)</span>
<span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">txt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df3</span><span class="p">[</span><span class="s">&#39;NLMO&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mf">0.3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="n">lastX</span><span class="p">,</span><span class="n">lastY</span><span class="p">),</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&#39;-&gt;&#39;</span><span class="p">,</span><span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> \
                             <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]),(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s">&#39;&lt;-&#39;</span><span class="p">,</span>\
                                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">total_dipole</span><span class="p">,</span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">lastX</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">lastY</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mf">1.1</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s">&#39;offset points&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">((</span><span class="n">quad</span><span class="p">),</span>  <span class="c"># asumX, asumY, </span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xmin</span><span class="o">+</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">ymax</span><span class="o">-</span><span class="mf">0.6</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
             <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s">&#39;offset points&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">,</span>
             <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">cenX</span><span class="p">,</span> <span class="n">cenY</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">textcoords</span><span class="o">=</span><span class="s">&#39;offset points&#39;</span><span class="p">)</span>

<span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">&#39;level_0&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">classes</span> <span class="o">=</span> <span class="s">&#39;grid&#39;</span><span class="p">,</span> <span class="n">escape</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe grid">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NLMO</th>
      <th>Type</th>
      <th>X</th>
      <th>Y</th>
      <th>Z</th>
      <th>Tot_Dip</th>
      <th>newX</th>
      <th>newY</th>
      <th>xyRank</th>
      <th>slope</th>
      <th>newXa</th>
      <th>newYa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td></td>
      <td>0.00</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>4</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>BD ( 1) C 2- H 6</td>
      <td>1.72</td>
      <td>0</td>
      <td>-0.58</td>
      <td>1.82</td>
      <td>1.72</td>
      <td>-0.58</td>
      <td>3</td>
      <td>-0.337209</td>
      <td>1.72</td>
      <td>-0.58</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>LP ( 1) N 1</td>
      <td>-0.20</td>
      <td>0</td>
      <td>-1.64</td>
      <td>1.65</td>
      <td>-0.20</td>
      <td>-1.64</td>
      <td>2</td>
      <td>8.200000</td>
      <td>1.52</td>
      <td>-2.22</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>BD ( 1) C 2- O 3</td>
      <td>-1.90</td>
      <td>0</td>
      <td>-1.44</td>
      <td>2.38</td>
      <td>-1.90</td>
      <td>-1.44</td>
      <td>2</td>
      <td>0.757895</td>
      <td>-0.38</td>
      <td>-3.66</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>LP ( 1) O 3</td>
      <td>-2.37</td>
      <td>0</td>
      <td>-1.64</td>
      <td>2.88</td>
      <td>-2.37</td>
      <td>-1.64</td>
      <td>2</td>
      <td>0.691983</td>
      <td>-2.75</td>
      <td>-5.30</td>
    </tr>
    <tr>
      <th>5</th>
      <td>11</td>
      <td>BD ( 2) C 2- O 3</td>
      <td>-0.67</td>
      <td>0</td>
      <td>-0.46</td>
      <td>0.81</td>
      <td>-0.67</td>
      <td>-0.46</td>
      <td>2</td>
      <td>0.686567</td>
      <td>-3.42</td>
      <td>-5.76</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8</td>
      <td>BD ( 1) N 1- H 4</td>
      <td>-0.68</td>
      <td>0</td>
      <td>0.47</td>
      <td>0.82</td>
      <td>-0.68</td>
      <td>0.47</td>
      <td>1</td>
      <td>-0.691176</td>
      <td>-4.10</td>
      <td>-5.29</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>BD ( 1) N 1- C 2</td>
      <td>0.02</td>
      <td>0</td>
      <td>0.85</td>
      <td>0.85</td>
      <td>0.02</td>
      <td>0.85</td>
      <td>0</td>
      <td>42.500000</td>
      <td>-4.08</td>
      <td>-4.44</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6</td>
      <td>LP ( 2) O 3</td>
      <td>0.89</td>
      <td>0</td>
      <td>0.75</td>
      <td>1.16</td>
      <td>0.89</td>
      <td>0.75</td>
      <td>0</td>
      <td>0.842697</td>
      <td>-3.19</td>
      <td>-3.69</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>BD ( 1) N 1- H 5</td>
      <td>0.75</td>
      <td>0</td>
      <td>0.46</td>
      <td>0.88</td>
      <td>0.75</td>
      <td>0.46</td>
      <td>0</td>
      <td>0.613333</td>
      <td>-2.44</td>
      <td>-3.23</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
hu7f/gAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div></p>
<p>An alternative and acceptable vector decomposition is shown in <strong>Figure 4</strong>.</p>
<p><img alt="Figure 4" src="./notebook/dipoles-blog/dipoles/form_dip_3210_.png" /></p>
<p><span style="color:orange; margin-left: 110px"><strong>Figure 4</strong></span></p>
<p>This concludes the analysis of NLMO dipole moment data from the NBO output file. Several vector paths composed of partial formamide dipoles were created and saved as images.
Next step will be analysis of partial NLMO dipoles in terms of bonds and lone pair contributions.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
      <div class="article-comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'ntlines'; // required: replace example with your forum shortname

                    var disqus_identifier = 'Natural-Dipole-Analysis';
                var disqus_url = 'http://marpat.github.com/Natural-Dipole-Analysis.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
     </div>
    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
		<div id="photo">
		</div>
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://www.google.com/+MarcelPatek"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                <li class="list-group-item"><a href="http://www.linkedin.com/in/marcelpatek"><i class="fa fa-linkedin-square fa-lg"></i> LinkedIn</a></li>
              </ul>
            </li>


            <li class="list-group-item"><a href="./"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="./category/blogging.html">
                            <i class="fa fa-folder-open fa-lg"></i> Blogging
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="./category/nbo.html">
                            <i class="fa fa-folder-open fa-lg"></i> NBO
                        </a>
                    </li>
                </ul>
            </li>

            <li class="list-group-item"><a href="./tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-4">
                        <a href="./tag/anaconda.html">
                            Anaconda
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="./tag/blogging.html">
                            Blogging
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="./tag/ipython-notebook.html">
                            iPython Notebook
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="./tag/pelican.html">
                            Pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="./tag/python.html">
                            Python
                        </a>
                    </li>
                </ul>
            </li>

    <li class="list-group-item"><h4><i class="fa fa-twitter fa-lg"></i><span class="icon-label">Latest Tweets</span></h4></li>
    <div id="twitter_timeline">
        <a class="twitter-timeline" data-chrome="noheader" href="https://twitter.com/mpatek_" data-widget-id="561339678725382144">Tweets by mpatek_</a>
    </div>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://nbo.marcelpatek.com/" target="_blank">
                NBO
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://chemgplus.blogspot.com" target="_blank">
                OrgMedChem - NBO Blogger
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://script-orgmedchem.blogspot.com" target="_blank">
                OrgMedChem - scripts
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://github.com/marpat/" target="_blank">
                Github
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://www.youtube.com/user/orgmedchem" target="_blank">
                YouTube
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www.marcelpatek.com/" target="_blank">
                Digital Photography
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Marcel Patek
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>
<!-- Custom js-->
<script src="./extras/js/emailshow.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>

    <script src="./theme/js/bodypadding.js"></script>
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'ntlines'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-66366688-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>